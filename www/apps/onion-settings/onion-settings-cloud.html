<link rel="import" href="/lib/polymer/polymer.html">
<link rel="import" href="/elements/bootstrap-alert/bootstrap-alert-container.html">

<dom-module id="onion-settings-cloud">
	<style>
		.container {
			width: 600px;
			margin: 0 auto;
		}

		.card {
			margin-top: 15px;
			background-color: #fff;
		}
			.card .form-group:last-child {
				margin-bottom: 0;
			}
	</style>

	<template>

		<div class="container">
			<form id="settings">
				<h4>Onion Cloud client Settings</h4>
				<div class="card card-block">
					<!-- check current root password -->
					<div class="form-group row">
						<label for="password-current" class="col-lg-4 col-md-4 col-sm-4 col-xs-4 form-control-label">Current Password</label>
						<div class="col-lg-8 col-md-8 col-sm-8 col-xs-8">
							<input type="password" class="form-control" id="password-current" autocomplete="off" value="{{passwordCurrent::input}}" />
						</div>
					</div>
					<!-- new root password -->
					<div class="form-group row">
						<label for="password-new" class="col-lg-4 col-md-4 col-sm-4 col-xs-4 form-control-label">New Password</label>
						<div class="col-lg-8 col-md-8 col-sm-8 col-xs-8">
							<input type="password" class="form-control" id="password-new" autocomplete="off" value="{{passwordNew::input}}" />
						</div>
					</div>
				</div>

				<br />

				<div class="form-group row">
					<!-- save settings -->
					<div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
						<button id="wifi-config-button" type="button" class="btn btn-success btn-block" on-tap="saveSettings">Save Settings</button>
					</div>
				</div>
			</form>
		</div>

	</template>

	<script>
		'use strict';

		(function () {
			var ready = function () {
			};

			var saveSettings = function () {
				onionConsole.getService('onion-ubus-provider', (function (ubus) {
					ubus.request('uci', 'get', {
						config: 'system',
						section: '@system[0]',
						option: 'hostname'
					}, (function (result) {
						if (result.length === 2 && result[0] === 0) {
							this.hostnameCopy = result[1].value;
							this.hostname = result[1].value;
						}
					}).bind(this));
				}).bind(this));
			};
			
			var loadSettings = function () {
				onionConsole.getService('onion-ubus-provider', (function (ubus) {
					ubus.request('uci', 'get', {
						config: 'system',
						section: '@system[0]',
						option: 'hostname'
					}, (function (result) {
						if (result.length === 2 && result[0] === 0) {
							this.hostnameCopy = result[1].value;
							this.hostname = result[1].value;
						}
					}).bind(this));
				}).bind(this));
			}

			Polymer({
				is: 'onion-settings-cloud',
				ready: ready,
				saveSettings: saveSettings,
				loadSettings: loadSettings,
			});
		})();
	</script>

</dom-module>
